## 日記

### 10/4 12:30

12時の開始直後に偶然気付いたので問題を読む。
面白そう。
なんというかmemory allocationとかschedulingという語が連想される。
生成されるクッキーの面積や時間や得点の傾向への依存が強そう。
とりあえず貪欲をしたい。

### 10/4 13:50

中身のコードを読んでる。

乱数生成器がxorshiftなのでにゃんできないかな。
まあ難しいしできてもあまり使えなさそう。

盤面は 20 x 20 で固定。
これけっこう小さい気がする。

生地生成は次の手順:

1.  外周の半分を一様乱数で選ぶ
    -   小 [2, 5] x 2
    -   大 [7, 10] x 2
1.  折る位置を一様乱数で選ぶ
1.  縦横比を計算
1.  原始スコアを一様乱数で選ぶ
    -   小 [27, 45]
    -   大 [1280, 1920]
1.  スコア係数を一様乱数で選ぶ
    -   小 [0.2, 0.4]
    -   大 [x - 0.3, x + 0.3] ただし x in [0.3, 0.6] は事前に固定される
1.  スコアを計算
    -   原始スコア x スコア係数
1.  必要加熱ターン数を計算
    -   原始スコア / 面積

面積 x 時間 がだいたい点数になるようになってる。
回転率の方が重要だしオーブンの稼働率だけ見るのでよさそう。

## 10/4 15:00

とりあえず貪欲を書いたので提出。
左上から置けるものを置いていくだけ。
手元のTotalScore: 2,418,095で順位表は2位。

## 10/4 15:20

ちょっと修正したら1位。
TotalScore: 2,474,989。
kurenai3110 と kosakkun を煽って今日は終了です。

## 10/8 11:00

多少手の込んだ戦略をしてみたがだめ。
TotalScore: 2,323,048とか。

## 10/8 13:00

そもそも小型クッキーはたいして効いておらず70,000とかだけなので、ひとまずは大型クッキーのみに絞って頑張るのがよさそう。

ちゃんとやったら TotalScore: 2,515,121。
まあビームサーチ。

## 10/8 14:00

`ステータス：warning-error` って出るのが解消できない。
compileに失敗したのか実行時に失敗したのか曖昧だしもうちょっとまともな表示をしてほしい。
もし前者ならどういう環境なのか、せめてcompilerの名前ぐらいはほしいのだけどどこにも書いてない。

compileに失敗するようなものを投げるとこれも `ステータス：warning-error` だが `エラーメッセージ：` にcompilerの出力が表示される。
`エラーメッセージ：` と `Runtime Error` が別の行にあるので勘違いしていたが、標準エラー出力の欄ではなく単に RE したということを言っているらしい。

## 10/8 15:40

やっと解決。
おそらく内部でMLEしていた。

## 10/8 19:10

ジャッジか順位表かのどちらかが壊れていてTLEが存在してないように見える。
まあ放っておけばmask解除のときに顕在化して直るでしょう。

## 10/8 19:20

ビームサーチ中でWaitをしてなかったのをなんとかした。
手元 TotalScore: 2,619,656。
提出できる時間にも収めて6位。

要パラメタ調整。
深さはあまりいらないぽいなど。

手元チェックはせめて100ケースでやるべき。
あとちゃんと並列化と集計をする。
どちらも微妙に面倒なので面倒。

## 10/8 21:00

点数がまったく伸びないのでつらくなってきた。
まだ今日は2日目だし今日は終わりです。

## 10/9 15:00

時間制限が付いたらしい。
リジャッジもあった。
でもスコア公開はなし。

## 10/9 17:00

細かいバグを潰して鯖上のスコア 2,537,201から2,555,858に。
7位から5位。
まだこのあたりは混戦か。
とりあえずは差分更新などをきっちり書いて定数倍高速化か。

## 10/9 21:20

ぜんぜんだめ。
定数倍高速化すらあまりうまくいってない。

## 10/9 22:00

諸々のバグが取れた結果か、深さを上げるのがちゃんと効くようになった。

ひとまず次はパラメタ調整と定数倍高速化か。
評価関数の実際の値を確認して詳細な検討するやつも必要。

## 10/10 18:20

朝にお風呂で思い付いた点を修正したが失敗。
ついでに1点修正したらそっちは効いて1位。
スコア 2,643,051。
試したのはどちらも小型クッキーと大型クッキーの干渉防止の機構で、失敗した方はビームサーチをだんだん細めて先の方までの結果を得るもの、成功した方はそれ用の不等式に余裕持たせてたのを厳密にしたもの。

ビームをだんだん細めるのでなくてビーム結果に貪欲に後ろを付け足すとかするのも試す。
小型クッキーのビームサーチ化はやってないままなので忘れずやる。

## 10/10 18:40

しかしちゃんと時間を使ってるのがまだ3人しかいない。
まだまだ中盤戦という感じがする。
むしろ9秒や0.5秒で上位の人の方が怖い。

```
順位	ニックネーム	区分	応募日時	スコア	時間(秒)
1	kimiyuki	学生	2018-10-10 18:23:11	2,643,051	57.6875
2	kurenai3110	学生	2018-10-08 01:28:42	2,620,558	58.0625
3	kotamanegi	学生	2018-10-09 08:29:46	2,607,481	54.8359
4	c7c7	学生	2018-10-10 17:41:58	2,589,527	9.6796
5	さはら	学生	2018-10-10 13:45:02	2,583,597	28.5625
6	sk	学生	2018-10-09 21:38:00	2,571,812	16.8593
7	noge	ハル研	2018-10-09 23:05:58	2,555,462	1.7187
8	aquaCS	学生	2018-10-07 15:27:16	2,551,207	2.5234
9	Intyamada	学生	2018-10-07 00:15:43	2,547,038	0.5703
10	planetary	学生	2018-10-07 02:24:06	2,538,458	1.2109
```

やってないこと。
評価関数の高速な差分更新。
評価関数の実際の値の確認。
ビームサーチ結果の木の使い回し。
スコア値がぴったり一致するかで重複排除はどうか。
現状のアルゴリズムだと「焼き時間の長いクッキーが焼け終わった後その次が上手く焼けるか」がほぼ考慮できてない。

## 10/10 19:00

ほとんど同じ提出を投げてもTLEしたりしなかったりする。
風水みがつよい。

## 10/11 00:00

kurenai3110に1位を奪われたので頑張る

## 10/11 05:00

もうだめ

## 10/11 06:10

なんとか勝利を収めた。
小型クッキーのビームサーチ化が芳しくなかったので、もうむしろまったくの貪欲でよくないかと思って試したら正解。
さらにビーム幅を縮めるやつも加えたらこれも正解だった。
kurenai3110を煽って就寝。

## 10/11 06:20

そういえば小型クッキー主体で戦うとよいケースがあるかどうか確認してない。

ところで焼き鈍し方面を検討してない。
大型クッキーならどうせ重ならないしありなのでは。
